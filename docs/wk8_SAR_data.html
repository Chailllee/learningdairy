<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>learningDiary - 8&nbsp; Week8 - Synthetic Aperture Radar (SAR) data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./wk7_classification2.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./wk8_SAR_data.html"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Week8 - Synthetic Aperture Radar (SAR) data</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">learningDiary</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About me</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Week1 - Introduction of RS</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wk2_xaringen.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Week 2 - Xaringen</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wk3_RS_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Week3 - Remote Sensing Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wk4_policy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Week4 - Policy Applications</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wk5_GEE.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Week5 - Google Earth Engine</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wk6_classification1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Week6 - Classification-I</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wk7_classification2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Week7 - Classification and Accuracy</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wk8_SAR_data.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Week8 - Synthetic Aperture Radar (SAR) data</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#sar-data-analysis" id="toc-sar-data-analysis" class="nav-link active" data-scroll-target="#sar-data-analysis"><span class="header-section-number">8.1</span> SAR Data Analysis</a>
  <ul class="collapse">
  <li><a href="#key-concepts-covered" id="toc-key-concepts-covered" class="nav-link" data-scroll-target="#key-concepts-covered"><span class="header-section-number">8.1.1</span> <strong>Key Concepts Covered</strong>:</a></li>
  <li><a href="#difference-of-other-sarshahzad-et-al.-2024wk8_sar_data-4" id="toc-difference-of-other-sarshahzad-et-al.-2024wk8_sar_data-4" class="nav-link" data-scroll-target="#difference-of-other-sarshahzad-et-al.-2024wk8_sar_data-4"><span class="header-section-number">8.1.2</span> Difference of other SAR(Shahzad et al., 2024)</a></li>
  </ul></li>
  <li><a href="#sar-data-thermal-infrared-data-for-surface-temperature-analysis" id="toc-sar-data-thermal-infrared-data-for-surface-temperature-analysis" class="nav-link" data-scroll-target="#sar-data-thermal-infrared-data-for-surface-temperature-analysis"><span class="header-section-number">8.2</span> SAR Data &amp; Thermal Infrared Data for Surface Temperature Analysis</a>
  <ul class="collapse">
  <li><a href="#why-combine-sar-and-tir" id="toc-why-combine-sar-and-tir" class="nav-link" data-scroll-target="#why-combine-sar-and-tir"><span class="header-section-number">8.2.1</span> Why Combine SAR and TIR?</a></li>
  <li><a href="#application-for-integrating-sar-and-tir-data" id="toc-application-for-integrating-sar-and-tir-data" class="nav-link" data-scroll-target="#application-for-integrating-sar-and-tir-data"><span class="header-section-number">8.2.2</span> Application for Integrating SAR and TIR Data</a></li>
  </ul></li>
  <li><a href="#reflection" id="toc-reflection" class="nav-link" data-scroll-target="#reflection"><span class="header-section-number">8.3</span> Reflection</a></li>
  <li><a href="#reference" id="toc-reference" class="nav-link" data-scroll-target="#reference"><span class="header-section-number">8.4</span> Reference</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Week8 - Synthetic Aperture Radar (SAR) data</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Summary
</div>
</div>
<div class="callout-body-container callout-body">
<p>This class introduces the basic principle of synthetic aperture radar (SAR), two sensor types, SAR data background, SAR data value, SAR polarization, SAR background, differential interferometric synthetic aperture radar (DlnSAR), SAR data processing, SAR data fusion, SAR image fusion and other concepts.</p>
<p>This class also introduces how to use SAR data for change detection, including statistical test, threshold screening and ROC curve, image fusion and so on. Finally, a change detection algorithm based on SAR data is proposed, and an example is given.</p>
</div>
</div>
<section id="sar-data-analysis" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="sar-data-analysis"><span class="header-section-number">8.1</span> SAR Data Analysis</h2>
<p><strong>Synthetic Aperture Radar (SAR)</strong> is a radar system that produces high-resolution images of the Earth’s surface by using the movement of the radar antenna to simulate a much larger aperture. SAR data can penetrate clouds and function during day and night, making it particularly useful in monitoring environmental and surface changes.</p>
<section id="key-concepts-covered" class="level3" data-number="8.1.1">
<h3 data-number="8.1.1" class="anchored" data-anchor-id="key-concepts-covered"><span class="header-section-number">8.1.1</span> <strong>Key Concepts Covered</strong>:</h3>
<ul>
<li><p><strong>SAR Sensors</strong>: We explored different SAR sensors, including Sentinel-1, and their capabilities in capturing radar signals.</p></li>
<li><p><strong>SAR Polarization</strong>: The ability of SAR to capture data in multiple polarizations, such as HH, HV, VV, and VH, provides deeper insights into surface characteristics.</p></li>
<li><p><strong>Interferometry</strong>: Techniques like InSAR and DInSAR were introduced, demonstrating how they are used to measure surface deformation by analyzing phase differences between radar images.</p></li>
<li><p><strong>Data Fusion</strong>: We learned about combining SAR data with optical imagery to improve accuracy in classification tasks, which is especially useful in urban mapping and land cover change detection (Wang, Jun et. al, 2024<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>).</p></li>
</ul>
</section>
<section id="difference-of-other-sarshahzad-et-al.-2024wk8_sar_data-4" class="level3" data-number="8.1.2">
<h3 data-number="8.1.2" class="anchored" data-anchor-id="difference-of-other-sarshahzad-et-al.-2024wk8_sar_data-4"><span class="header-section-number">8.1.2</span> Difference of other SAR(Shahzad et al., 2024<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>)</h3>
<table class="table">
<colgroup>
<col style="width: 27%">
<col style="width: 20%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th>SAR</th>
<th>InSAR</th>
<th>DInSAR</th>
<th>PSInSAR</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Synthetic Aperture Radar</td>
<td>Interferometric Synthetic Aperture Radar</td>
<td>Differential Interferometric Synthetic Aperture Radar</td>
<td>Persistent Scatterer Interferometric SAR</td>
</tr>
<tr class="even">
<td><ul>
<li><p>A radar system capable of producing high-resolution images.</p></li>
<li><p>Uses a “virtual” antenna length to combine echo signals received from different positions, resulting in higher-resolution radar imaging.</p></li>
<li><p>Used for surface observations such as land use, topography, and forest cover.</p></li>
</ul></td>
<td><ul>
<li><p>Analyzes surface deformation by exploiting the phase difference between two remote sensing images.</p></li>
<li><p>Calculates the deformation at each pixel on the ground surface between two observations.</p></li>
<li><p>Reveals elevation and deformation information.</p></li>
</ul></td>
<td><ul>
<li><p>Builds upon InSAR by using phase differences from multiple remote sensing images to improve deformation measurement accuracy.</p></li>
<li><p>Sensitive to deformation, suitable for monitoring ground surface changes due to earthquakes, mining, landslides, etc.</p></li>
<li><p>Utilizes two SAR images and external topographic data to measure subtle surface deformations.</p></li>
</ul></td>
<td><ul>
<li><p>Models and analyzes time series data from multiple SAR images to enhance deformation inversion accuracy.</p></li>
<li><p>Reveals spatial distribution of surface deformations, widely used for monitoring urban subsidence and infrastructure changes.</p></li>
</ul></td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="sar-data-thermal-infrared-data-for-surface-temperature-analysis" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="sar-data-thermal-infrared-data-for-surface-temperature-analysis"><span class="header-section-number">8.2</span> SAR Data &amp; Thermal Infrared Data for Surface Temperature Analysis</h2>
<p>Surface temperature analysis is a key aspect of understanding environmental changes, particularly in urban areas and regions affected by climate change. By integrating <strong>Synthetic Aperture Radar (SAR)</strong> data with <strong>Thermal Infrared (TIR)</strong> data, we can achieve a more holistic understanding of surface temperature variations and their influencing factors.</p>
<section id="why-combine-sar-and-tir" class="level3" data-number="8.2.1">
<h3 data-number="8.2.1" class="anchored" data-anchor-id="why-combine-sar-and-tir"><span class="header-section-number">8.2.1</span> Why Combine SAR and TIR?</h3>
<p>Combining <strong>SAR</strong> and <strong>Thermal Infrared (TIR)</strong> data provides a comprehensive view of surface temperature variations and their driving factors. <strong>SAR</strong> captures surface properties like roughness, moisture, and vegetation structure, while <strong>TIR</strong> measures <strong>Land Surface Temperature (LST)</strong>. This fusion allows for deeper environmental analysis and more accurate monitoring.</p>
<p>In <strong>urban heat island</strong> (UHI) studies, SAR data reveals urban structure and morphology, while TIR highlights temperature patterns. Together, they provide clearer insights into how urban features affect heat dynamics, supporting more effective urban planning.</p>
<p>Additionally, integrating <strong>SAR’s surface moisture</strong> measurements with <strong>TIR’s temperature data</strong> helps assess the link between moisture content and surface temperature. This is crucial for monitoring drought and land degradation, offering a fuller picture of environmental conditions.</p>
</section>
<section id="application-for-integrating-sar-and-tir-data" class="level3" data-number="8.2.2">
<h3 data-number="8.2.2" class="anchored" data-anchor-id="application-for-integrating-sar-and-tir-data"><span class="header-section-number">8.2.2</span> Application for Integrating SAR and TIR Data</h3>
<p>SAR data can provide a <strong>roughness index</strong> of the surface, which can be correlated with temperature patterns. For example, smoother surfaces like water bodies and urban concrete will reflect heat differently than rough surfaces like forests.</p>
<ol type="1">
<li><p><strong>Urban Heat Island Detection</strong>:</p>
<ul>
<li>By correlating LST from TIR data with <strong>building density</strong> and surface composition from SAR data, we can identify and monitor UHIs over time. This combination helps detect how specific materials and urban planning contribute to elevated temperatures in cities (Li et al., 2019<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>).</li>
</ul>
<p><img src="images/SHUI.jpg" class="img-fluid" alt="Spatial distribution of summer day-time (1:30 pm) SUHI for the conterminous U.S. in 2010."> Where SHUI is surface urban heat island. We can observed that larger urban areas display higher SUHI than smaller urban areas, indicating the increase of SUHI with the expansion of urban area size.</p></li>
<li><p><strong>Climate Change Impact</strong>:</p>
<ul>
<li>The combined use of SAR and TIR data allows for long-term monitoring of land-use changes and their thermal effects. As landscapes shift from vegetation to urban development, LST tends to rise. Monitoring these changes with SAR’s ability to detect deforestation and TIR’s temperature monitoring capacity provides a complete picture of land transformation impacts (Balzter et al., 2007<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>).</li>
</ul></li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/carbon.jpg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Vegetation carbon content (t/ha) at Monks Wood NNR derived from the canopy height models from (a) LIDAR DSM and LIDAR DTM, (b) XVV InSAR DSM and LIDAR DTM, (c) XVV InSAR DSM and smoothed interpolated LHH InSAR DTM (dual wavelength approach). All images were averaged to 21 m pixel spacing as required by the Marrakech Accords to the Kyoto protocol. Color scale : 5…400 tC/ha.</figcaption>
</figure>
</div>
<p>This figure illustrates how different terrain removal approaches, using both SAR and LIDAR, can provide comprehensive insights into vegetation carbon content. As shown by Balzter et al.&nbsp;(2007), combining X-VV interferometry DSM with LIDAR DSM and LIDAR DTM enhances the accuracy of carbon mapping. Such integration is crucial for monitoring carbon stocks and understanding the effects of land-use changes on carbon sequestration. By combining SAR and TIR data, long-term land-use monitoring becomes more precise, enabling better assessment of the environmental impact of urbanization and deforestation.</p>
</section>
</section>
<section id="reflection" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="reflection"><span class="header-section-number">8.3</span> Reflection</h2>
<p>This week’s exploration of SAR data and its integration with thermal infrared (TIR) data provided valuable insights into the broader applications of remote sensing for environmental monitoring. One key takeaway is the versatility of SAR in detecting surface characteristics such as roughness, moisture content, and urban structures, which, when combined with TIR data, offers a more comprehensive analysis of surface temperature variations. This multi-faceted approach is particularly useful in studying phenomena like urban heat islands and land-use changes.</p>
<p>Understanding the combination of SAR and TIR data also highlighted the potential for improving climate change monitoring. The ability to track both land surface temperature and environmental changes in urban areas and natural landscapes makes this method crucial for addressing real-world problems such as deforestation, drought, and urbanization impacts. The class has deepened my appreciation of how fusing different types of geospatial data can lead to more precise and actionable environmental insights, reinforcing the importance of integrating multiple datasets for comprehensive analysis in future geospatial projects.</p>
</section>
<section id="reference" class="level2" data-number="8.4">
<h2 data-number="8.4" class="anchored" data-anchor-id="reference"><span class="header-section-number">8.4</span> Reference</h2>


</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>Wang, Jun, Yanlong Wang, Guang Li, and Zhengyuan Qi. 2024. “Integration of Remote Sensing and Machine Learning for Precision Agriculture: A Comprehensive Perspective on Applications” Agronomy 14, no. 9: 1975. https://doi.org/10.3390/agronomy14091975<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Shahzad, Naeem, and Xiaoli Ding. 2024. “An Improved Time Series SAR Interferometry (TSInSAR) for Investigating Earthquake-Induced Active Unstable Slopes (AUS) in Pakistan.” International Journal of Remote Sensing 45 (18): 6342–71. doi:10.1080/01431161.2024.2391106.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>Li, X., Zhou, Y., Zhu, Z., and Asrar, G.R., 2019. The surface urban heat island response to urban expansion: A panel analysis for the conterminous United States. <em>Remote Sensing of Environment</em>, 235, p.111446.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>Balzter, H., Rowland, C.S., and Saich, P., 2007. Forest canopy height and carbon estimation at Monks Wood National Nature Reserve, UK, using dual-wavelength SAR interferometry. <em>Remote Sensing of Environment</em>, 108(3), pp.224-239.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./wk7_classification2.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Week7 - Classification and Accuracy</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->



</body></html>